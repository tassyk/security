---
Title: Security Tools
Type: Doc
Nature: Notes
Création: 15/05/2020
---

#  Web pentest Labs

##  Vuln box
- Applications vulnérables :
  - [DVWA](http://www.dvwa.co.uk/) : Application web PHP/Mysql vulnérable
  - [bWAPP](www.itsecgames.com) : Application web PHP/Mysql vulnérable
  - [OWASP Mutillidae](https://sourceforge.net/projects/mutillidae/) : Application vulnérable d'OWASP
  - [OWASP Juice Shop](https://owasp.org/www-project-juice-shop/) : Application vulnerable développée en Node.js, Express et Angular
  - [BodgIT](https://github.com/psiinon/bodgeit) : Application java vulnerable application
  - [vulnweb](http://www.vulnweb.com/) : Site web vulnérable en ligne (for Acunetix Web Vulnerability Scanner)
-  VM vulnérables
  - [Metasploitable3](https://github.com/rapid7/metasploitable3) : Linux vulnerable VM
  -  [Metasploitable2](https://metasploit.help.rapid7.com/docs/metasploitable-2) : Linux vulnerable VM
  - [bee-box](https://sourceforge.net/projects/bwapp/files/bee-box/) :  VM linux preconfiguré avec bWAPP
  - [vulnhub](https://www.vulnhub.com/) : Vulnerable test VM

## Mise en place des applications vulnérables
> La plupart de ces applications vulnérables peuvent être installées from source ou via Docker.

### Prerequis
Prerequis pour les installations `from source` des applications basées sur PHP/Mysql:
- Installation des paquets nécessaires : `git, wget`
```
sudo yum install -y git wget
```
- Installation de Httpd, PHP/Mysql
```
# apache
sudo yum install httpd
sudo systemctl start httpd
sudo systemctl enable httpd
# php et modules  
sudo yum install php php-common php-gd php-mbstring php-mysql php-pdo # php-54 (from remi-ph54 repo)
# mysql/mariadb
sudo yum install -y mariadb-server mariadb # mariadb55 (from base repo)
sudo systemctl start mariadb
sudo systemctl enable mariadb
#sudo mysql_secure_installation # pour sécuriser la base de données
```
- Création de la base de données pour l'application
```
mysql -u root -p
MariaDB [(none)]> create database applidb;
MariaDB [(none)]> create user appliuser@localhost identified by 'applipass';
MariaDB [(none)]> grant all on applidb.* to appliuser@localhost identified by 'applipass';
MariaDB [(none)]> flush privileges;
MariaDB [(none)]> quit
```
> noms DB, user et pass à adapeter en fonction de l'application

Prerequis pour les installations `from source` des applications basées Nodejs :
- installer Nodejs
```
sudo yum install -y gcc-c++ make
sudo yum install -y nodejs
```

### Installation de DVWA
[DVWA](http://www.dvwa.co.uk/) est application web PHP/Mysql vulnérable. Elle peut être installée comme suit :
- clone du dépôt git de l'application
```
cd /var/www/html
git clone https://github.com/ethicalhack3r/DVWA.git
sudo mv DVWA dvwa
sudo chmod -R 777 dvwa
```
- configuration de la base de données : voir prerequis

- configuration de php
```
$ cat /etc/php.ini
allow_url_fopen = On # Allows for Remote File Inclusions (RFI)
allow_url_include = On # Allows for Remote File Inclusions (RFI)
display_errors = Off # (Optional) Hides PHP warning messages to make it less verbose
```
- configuration de DVWA
```
sudo cp dvwa/config/config.inc.php.dist dvwa/config/config.inc.php
# adapter les info du fichier dvwa/config/config.inc.php
$_DVWA[ 'db_server' ]   = '127.0.0.1';
$_DVWA[ 'db_database' ] = 'dvwadb';
$_DVWA[ 'db_user' ]     = 'dvwauser';
$_DVWA[ 'db_password' ] = 'p@ssw0rd';
# clé recaptcha (à créer sur: https://www.google.com/recaptcha/admin)
$_DVWA[ 'recaptcha_public_key' ]  = 'recaptcha_public_key';
$_DVWA[ 'recaptcha_private_key' ] = 'recaptcha_private_key';
```
- Finalisation de la configuration via l'interface web : http://IP_server/dvwa/setup.php
> Corriger les erreurs s'il y en a
> Cliquer sur Create/Reset database
> Login : admin/password

### Installation de bWAPP
[bWAPP](https://sourceforge.net/projects/bwapp/) est application web PHP/Mysql vulnérable. Elle fait partie du projet [ITSEC GAMES](www.itsecgames.com). Elle peut être [installée](http://itsecgames.blogspot.com/2013/01/bwapp-installation.html) comme suit :
- Télécharger l'archive de l'application
```
sudo wget https://sourceforge.net/projects/bwapp/files/latest/download
```
- décompresser le paquet et définir les permissions
```
cd /var/www/html
sudo unzip download -d bwapp
sudo chmod -R 777 bwapp/bWAPP/passwords/
sudo chmod 777 bwapp/bWAPP/images/
```
- configuration de la base de données : voir prerequis
> Attention: ne pas créer de base de données. bWAPP utilise bWAPP comme nom de base de données par défaut

- Adapter les paramètres
```
$ cat bwapp/bWAPP/admin/settings.php
// Database connection settings
$db_server = "localhost";
$db_username = "bwapp";
$db_password = "bwapp";
$db_name = "bWAPP";
```
- Finalisation de l'installation via l'interface web : http://IP_server/bwapp/bWAPP/install.php
> Cliquer sur le bouton `here`
> Sur la page de login, entrer `bee/bug` pour s'authentifier.

### Installation d'OWASP Mullitidae
[OWASP Mullitidae](https://github.com/webpwnized/mutillidae) est application web PHP/Mysql vulnérable comportant les dernières vulnérabilités du top 10 d'OWASP. Elle peut être [installée](http://itsecgames.blogspot.com/2013/01/bwapp-installation.html) comme suit :

- Cloner le dépôt Github du projet
```
cd /var/www/html
sudo git clone https://github.com/webpwnized/mutillidae.git
```
- configuration de la base de données : voir prerequis
> Note seul la création de la BD est requise. Le user est optionnel

- définition des permissions
```
sudo chmod -R 777 mutillidae
```
- (optionnel) adaptation des paramètres de la base de données dans `mutillidae/classes/MySQLHandler.php`
```
static public $mMySQLDatabaseUsername = DB_USERNAME;
static public $mMySQLDatabasePassword = DB_PASSWORD;
static public $mMySQLDatabaseName = DB_NAME;
```
> A faire, si on souhaite changer les paramètres de la base de données

- Finalisation de l'installation via l'interface web : http://IP_server/mutillidae
> Cliquer sur le bouton `Opt out` puis sur `setup/reset the DB`
> Explorer les challenges et apprécier!

### Installation d'OWASP Juice Shop
[OWASP Juice Shop](https://owasp.org/www-project-juice-shop/) est application Javascript vulnérable développée en Node.js, Express et Angular. Elle peut être [installée](https://github.com/bkimminich/juice-shop#from-sources) comme suit :

- Installation de Nodejs : voir prérequis (pour nodejs)

- Cloner le dépôt Github de l'application
```
sudo git clone https://github.com/bkimminich/juice-shop.git
```
- Installer et démarrer l'application
```
cd juice-shop
sudo npm install
sudo npm start
```
- Connexion à l'interface web : http://IP_server:3000


## Liens
- Tutorials
  - [DVWA sous centos](https://kifarunix.com/install-and-setup-dvwa-on-centos-8/)
  - [bWAPP sous Kali](https://www.kalilinux.in/2020/02/bwapp-in-kali-linux-2020.html)
  - [Mutillidae installation](https://pycycle.info/2016/how-to-setup-mutillidae.html)
  - [Juice Shop installation from source](https://github.com/bkimminich/juice-shop#from-sources)
